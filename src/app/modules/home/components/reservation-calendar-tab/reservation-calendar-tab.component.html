<mat-card>
  <div class="calendar">
    <header class="calendar__header">
      <form class="calendar__options" [formGroup]="filterGroup">
        <div class="calendar__options-left">
          <button
            mat-button
            (click)="calendar.refresh()"
            type="button"
            aria-label="Refresh"
            class="calendar__refresh"
            *ngIf="
              (tabletSizeHit$ | async)?.matches === false;
              else iconOnlyRefresh
            "
          >
            <mat-icon>refresh</mat-icon>&nbsp;Refresh
          </button>

          <ng-template #iconOnlyRefresh>
            <button
              mat-icon-button
              (click)="calendar.refresh()"
              type="button"
              class="calendar__refresh"
            >
              <mat-icon>refresh</mat-icon>
            </button>
          </ng-template>

          <mat-checkbox
            color="primary"
            formControlName="highlightMine"
            class="calendar__highlight-mine"
            >Highlight mine</mat-checkbox
          >
        </div>
        <div class="calendar__options-right">
          <mat-form-field
            appearance="outline"
            class="unpadded calendar__resource-selection"
          >
            <mat-label>Physical resource</mat-label>
            <mat-select
              #resourceSelect
              formControlName="resource"
              (valueChange)="calendar.fetchReservations()"
            >
              <mat-option>
                <ngx-mat-select-search
                  formControlName="resourceFilter"
                  placeholderLabel="Search..."
                  noEntriesFoundLabel="No resources found"
                ></ngx-mat-select-search>
              </mat-option>
              <mat-option
                *ngFor="let resource of filteredResources"
                [value]="resource.id"
              >
                {{ resource.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </form>

      <section class="calendar__navigation">
        <app-calendar-view-selection
          *ngIf="(tabletSizeHit$ | async)?.matches === false; else jumpToDate"
          [selectedView]="calendar.view"
          [tabletSizeHit$]="tabletSizeHit$"
          (viewSelected)="calendar.view = $event"
        ></app-calendar-view-selection>

        <ng-template #jumpToDate>
          <button
            mat-button
            (click)="picker.open()"
            class="calendar__datepicker"
          >
            <mat-icon>event</mat-icon>&nbsp;Jump to date
          </button>
          <input
            type="date"
            style="visibility: hidden; width: 0; height: 0"
            [matDatepicker]="picker"
            (dateInput)="onDateSelection($event.value)"
          />
          <mat-datepicker #picker></mat-datepicker>
        </ng-template>

        <h1 class="calendar__view-date">
          {{ calendar.viewDate | calendarDate: calendar.view + "ViewTitle" }}
        </h1>

        <app-calendar-paginator
          class="calendar__paginator"
          [view]="calendar.view"
          [viewDate]="calendar.viewDate"
          (viewDateChange)="calendar.viewDate = $event"
        ></app-calendar-paginator>
      </section>
    </header>

    <app-reservation-calendar
      #calendar
      [selectedResourceId]="resourceSelect.value"
    ></app-reservation-calendar>
  </div>
</mat-card>
